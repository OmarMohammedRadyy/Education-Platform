@model List<EducationPlatformN.Models.SubscriptionViewModel>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <title>اشتراكاتي - منصة عمر</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700&display=swap" rel="stylesheet" />
    <link href="~/css/site.css" rel="stylesheet" />
</head>
<body>
    <!-- Subscriptions Section -->
    <div class="subscriptions-section">
        <div class="container">
            <div class="subscriptions-container">
                <h2>اشتراكاتي</h2>

                @if (Model != null && Model.Any())
                {
                    <table class="table">
                        <thead>
                            <tr>
                                <th>العنوان</th>
                                <th>المدرس</th>
                                <th>السعر</th>
                                <th>نسبة الإكمال</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var subscription in Model)
                            {
                                <tr>
                                    <td>@subscription.Title</td>
                                    <td>@subscription.TeacherName</td>
                                    <td>@subscription.Price ريال</td>
                                    <td>@subscription.CompletionPercentage.ToString("F2")%</td>
                                    <td>
                                        <a asp-action="Details" asp-controller="Course" asp-route-id="@subscription.CourseId" class="btn btn-primary">عرض الدورة</a>
                                        <a asp-action="MyLessons" asp-controller="Payment" asp-route-courseId="@subscription.CourseId" class="btn btn-info">عرض الدروس</a>
                                        @if (!string.IsNullOrEmpty(subscription.InvoiceUrl))
                                        {
                                            <a href="@subscription.InvoiceUrl" target="_blank" class="btn btn-success">تحميل الفاتورة</a>
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <div class="alert alert-info text-center">لم تقم بالاشتراك في أي دورة حاليًا.</div>
                }
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const subscriptions = @Html.Raw(Json.Serialize(Model));
            if (subscriptions.length > 0) {
                const courseId = subscriptions[0].courseId;
                document.getElementById('myLessonsLink')?.setAttribute('href', `/Payment/MyLessons?courseId=${courseId}`);
            }
        });
    </script>
</body>
</html>